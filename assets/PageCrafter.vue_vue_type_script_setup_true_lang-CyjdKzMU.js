function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/WidgetsRenderer-BICeIa_w.js","assets/index-DLozcEEb.js","assets/index-Bi55jKNN.css","assets/DynamicString-GcXm74I7.js","assets/VIf-4L9qVYZt.js","assets/VFor-BiS5zvxk.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{d as F,i as j,_ as R,k as pe,b as le,o as y,a as S,aX as ce,aY as z,w as J,F as ue,f as X,G as fe,aZ as he,aj as de,c as m,aU as L,Z as G,a1 as ve,L as Y,a_ as B,a$ as ge,V as ye,B as W,r as _e}from"./index-DLozcEEb.js";var C=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function be(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Me="Expected a function",Z="__lodash_hash_undefined__",Q=1/0,me="[object Function]",Se="[object GeneratorFunction]",Oe="[object Symbol]",Ve=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ce=/^\w*$/,je=/^\./,Re=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pe=/[\\^$.*+?()[\]{}|]/g,Ee=/\\(\\)?/g,De=/^\[object .+?Constructor\]$/,Ie=typeof C=="object"&&C&&C.Object===Object&&C,we=typeof self=="object"&&self&&self.Object===Object&&self,T=Ie||we||Function("return this")();function $e(e,t){return e==null?void 0:e[t]}function Fe(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch{}return t}var Te=Array.prototype,Ae=Function.prototype,ee=Object.prototype,w=T["__core-js_shared__"],N=function(){var e=/[^.]+$/.exec(w&&w.keys&&w.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),te=Ae.toString,A=ee.hasOwnProperty,re=ee.toString,xe=RegExp("^"+te.call(A).replace(Pe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),U=T.Symbol,ke=Te.splice,He=ae(T,"Map"),O=ae(Object,"create"),q=U?U.prototype:void 0,K=q?q.toString:void 0;function _(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Je(){this.__data__=O?O(null):{}}function Le(e){return this.has(e)&&delete this.__data__[e]}function Ge(e){var t=this.__data__;if(O){var r=t[e];return r===Z?void 0:r}return A.call(t,e)?t[e]:void 0}function Be(e){var t=this.__data__;return O?t[e]!==void 0:A.call(t,e)}function We(e,t){var r=this.__data__;return r[e]=O&&t===void 0?Z:t,this}_.prototype.clear=Je;_.prototype.delete=Le;_.prototype.get=Ge;_.prototype.has=Be;_.prototype.set=We;function M(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ne(){this.__data__=[]}function Ue(e){var t=this.__data__,r=P(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():ke.call(t,r,1),!0}function qe(e){var t=this.__data__,r=P(t,e);return r<0?void 0:t[r][1]}function Ke(e){return P(this.__data__,e)>-1}function ze(e,t){var r=this.__data__,n=P(r,e);return n<0?r.push([e,t]):r[n][1]=t,this}M.prototype.clear=Ne;M.prototype.delete=Ue;M.prototype.get=qe;M.prototype.has=Ke;M.prototype.set=ze;function b(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Xe(){this.__data__={hash:new _,map:new(He||M),string:new _}}function Ye(e){return E(this,e).delete(e)}function Ze(e){return E(this,e).get(e)}function Qe(e){return E(this,e).has(e)}function et(e,t){return E(this,e).set(e,t),this}b.prototype.clear=Xe;b.prototype.delete=Ye;b.prototype.get=Ze;b.prototype.has=Qe;b.prototype.set=et;function P(e,t){for(var r=e.length;r--;)if(ut(e[r][0],t))return r;return-1}function tt(e,t){t=ot(t,e)?[t]:nt(t);for(var r=0,n=t.length;e!=null&&r<n;)e=e[lt(t[r++])];return r&&r==n?e:void 0}function rt(e){if(!oe(e)||it(e))return!1;var t=ft(e)||Fe(e)?xe:De;return t.test(ct(e))}function at(e){if(typeof e=="string")return e;if(k(e))return K?K.call(e):"";var t=e+"";return t=="0"&&1/e==-Q?"-0":t}function nt(e){return ne(e)?e:pt(e)}function E(e,t){var r=e.__data__;return st(t)?r[typeof t=="string"?"string":"hash"]:r.map}function ae(e,t){var r=$e(e,t);return rt(r)?r:void 0}function ot(e,t){if(ne(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||k(e)?!0:Ce.test(e)||!Ve.test(e)||t!=null&&e in Object(t)}function st(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function it(e){return!!N&&N in e}var pt=x(function(e){e=dt(e);var t=[];return je.test(e)&&t.push(""),e.replace(Re,function(r,n,o,l){t.push(o?l.replace(Ee,"$1"):n||r)}),t});function lt(e){if(typeof e=="string"||k(e))return e;var t=e+"";return t=="0"&&1/e==-Q?"-0":t}function ct(e){if(e!=null){try{return te.call(e)}catch{}try{return e+""}catch{}}return""}function x(e,t){if(typeof e!="function"||t&&typeof t!="function")throw new TypeError(Me);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],l=r.cache;if(l.has(o))return l.get(o);var c=e.apply(this,n);return r.cache=l.set(o,c),c};return r.cache=new(x.Cache||b),r}x.Cache=b;function ut(e,t){return e===t||e!==e&&t!==t}var ne=Array.isArray;function ft(e){var t=oe(e)?re.call(e):"";return t==me||t==Se}function oe(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function ht(e){return!!e&&typeof e=="object"}function k(e){return typeof e=="symbol"||ht(e)&&re.call(e)==Oe}function dt(e){return e==null?"":at(e)}function vt(e,t,r){var n=e==null?void 0:tt(e,t);return n===void 0?r:n}var gt=vt;const $=be(gt),se=new RegExp(/(\{\{)[^{}]+(\}\})/),yt=F({props:{widget:{type:Object,default:()=>{}},widgetMap:{type:Object,default:()=>{}},eventMap:{type:Object,default:()=>{}},reactiveVariableMap:{type:Object,default:()=>{}}},components:{WidgetsRenderer:j(()=>R(()=>import("./WidgetsRenderer-BICeIa_w.js"),__vite__mapDeps([0,1,2])))},setup(e){return{props:e,...e.widget.props,get propsBindings(){const t={};return Object.keys(this).forEach(r=>{r!=="propsBindings"&&r!=="props"&&(t[r]=this[r])}),t}}}});function _t(e,t,r,n,o,l){const c=le("WidgetsRenderer");return y(),S(de(e.props.widgetMap[e.props.widget.type??""]??e.props.widget.type),fe(e.propsBindings,he(e.props.widget.events??{})),ce({default:J(()=>[e.props.widget.children?(y(),S(c,{key:0,widgets:e.props.widget.children,widgetMap:e.props.widgetMap,eventMap:e.props.eventMap,reactiveVariableMap:e.props.reactiveVariableMap},null,8,["widgets","widgetMap","eventMap","reactiveVariableMap"])):X("",!0)]),_:2},[z(Object.keys(e.props.widget.slots??{}),(a,p)=>({name:a,fn:J(s=>{var f;return[ue(c,{widgets:JSON.parse(JSON.stringify((e.props.widget.slots??{})[a])),widgetMap:e.props.widgetMap,eventMap:e.props.eventMap,reactiveVariableMap:{...e.props.reactiveVariableMap,[((f=e.props.widget.props)==null?void 0:f.id)??""+a+"SlotProps"]:s}},null,8,["widgets","widgetMap","eventMap","reactiveVariableMap"])]})}))]),1040)}const bt=pe(yt,[["render",_t]]),Mt=e=>{var c;const t=e.replace("{{","").replace("}}","").trim(),n=((c=new RegExp(/[\.\[\?]/).exec(t))==null?void 0:c.index)??-1;let o=t,l="";return n>-1&&(o=t.substring(0,n),l=t.substring(n+1)),{variablePart:o,theRest:l}},mt=(e,t,r={})=>{let n=e;const o=[];for(;n;){const l=se.exec(n);if(l==null){o.push(n),n="";continue}const c=l[0],a=l.index,p=a+c.length;a>0&&o.push(n.substring(0,a));const{variablePart:s,theRest:f}=Mt(c);t[s]!=null?o.push({rVar:t[s],theRest:f}):r[s]!=null?o.push(r[s]):o.push(c),p>=n.length?n="":n=n.substring(p)}return o},St=F({__name:"WidgetsRenderer",props:{widgets:{type:Array,default:()=>[]},widgetMap:{type:Object,default:()=>{}},eventMap:{type:Object,default:()=>{}},reactiveVariableMap:{type:Object,default:()=>{}}},setup(e){const t=j(()=>R(()=>import("./DynamicString-GcXm74I7.js"),__vite__mapDeps([3,1,2]))),r=j(()=>R(()=>import("./VIf-4L9qVYZt.js"),__vite__mapDeps([4,1,2]))),n=j(()=>R(()=>import("./VFor-BiS5zvxk.js"),__vite__mapDeps([5,1,2]))),o=e,l=m(()=>({...o.widgetMap,"v-if":r,"v-for":n})),c=m(()=>o.widgets.map(a=>(typeof a=="string"||(a.events&&Object.keys(a.events).forEach(p=>{if(!a.events)return;const s=a.events&&a.events[p];typeof s!="function"&&(s&&o.eventMap[s]?a.events[p]=o.eventMap[s]:a.events[p]=()=>{console.error(`Event ${s} not found`)})}),a.props&&Object.keys(a.props).forEach(p=>{if(a.props){if(a.props[p]){const s=a.props[p];if(typeof s=="string"&&se.exec(s)){const v=mt(s,o.reactiveVariableMap);if(v.length===1){const u=v[0];if(typeof u!="string"&&typeof u!="function"){const{rVar:h,theRest:g}=u;g?Y(h)?a.props[p]=$(h.value,g):a.props[p]=$(h,g):a.props[p]=h}else a.props[p]=u}else a.props[p]=m(()=>v.reduce((u,h)=>{if(typeof h=="function")return u;if(typeof h=="string")return u+h;const{rVar:g,theRest:D}=h;return D?u+=$(g.value,D):u+=g.value,u},""))}}if(p.includes("v-model")){const f=p.split(":")[1]??"modelValue";a.props[f]=a.props[p],a.events||(a.events={}),a.events[`update:${f}`]=v=>{a.props&&(a.props[p].value=v)}}}}),a.type==="v-if"&&(a.props||(a.props={}),a.props.widgetMap=l.value,a.props.eventMap=o.eventMap,a.props.reactiveVariableMap=o.reactiveVariableMap),a.type==="v-for"&&(a.props||(a.props={}),a.props.loopChildren=a.children,a.props.widgetMap=l.value,a.props.eventMap=o.eventMap,a.props.reactiveVariableMap=o.reactiveVariableMap)),a)));return(a,p)=>(y(!0),L(G,null,z(c.value,(s,f)=>(y(),L(G,{key:(typeof s=="string"?s:s.id+s.type)+f},[typeof s=="string"?(y(),S(ve(t),{key:0,str:s,reactiveVariableMap:o.reactiveVariableMap},null,8,["str","reactiveVariableMap"])):(y(),S(bt,{key:1,widget:s,widgetMap:l.value,eventMap:o.eventMap,reactiveVariableMap:o.reactiveVariableMap},null,8,["widget","widgetMap","eventMap","reactiveVariableMap"]))],64))),128))}});var ie=(e=>(e.Push="push",e.Replace="replace",e.ReplaceIfFirst="replaceIfFirst",e))(ie||{});const Vt=F({__name:"PageCrafter",props:B({widgetMap:{type:Object,default:()=>{}},eventMap:{type:Function,default:()=>{}},reactiveVariableMap:{type:Object,default:()=>{}},router:{type:Object,required:!1},route:{type:Object,required:!1}},{page:{type:Object,required:!1},pageModifiers:{}}),emits:B(["no-schema"],["update:page"]),setup(e,{expose:t,emit:r}){const n=ge(e,"page"),o=e,l=r,c={};let a=!1,p=!1;const s=ye(JSON.parse(JSON.stringify(null))),f=i=>{var d;if(p){p=!1;return}if(!(!((d=i.route)!=null&&d.path)||!o.route||!o.router)){try{sessionStorage.setItem(i.route.path,JSON.stringify(i))}catch(V){console.error("Some error in setting item in sessionStorage (probably data is too large or sessionStorage is full)",V),console.log("Using fallback cache"),c[i.route.path]=i}o.route.fullPath!==i.route.path&&(a=!0,i.route.navigationType===ie.Replace?o.router.replace(i.route.path):o.router.push(i.route.path))}},v=i=>{s.value=JSON.parse(JSON.stringify(i)),f(i)},u=()=>{l("no-schema"),a=!1,p=!1};W(n,()=>{n.value&&v(n.value)}),W(()=>{var i;return(i=o.route)==null?void 0:i.fullPath},()=>{var H;if(a){a=!1;return}if(!o.route||!o.router)return;const i=((H=o.route)==null?void 0:H.fullPath)??"";if(!i)return;const d=sessionStorage.getItem(i);if(d){try{const I=JSON.parse(d);n.value=I,p=!0}catch(I){console.error("Unable to parse cached schema",I),sessionStorage.removeItem(i)}return}const V=c[i];if(V){n.value=V,p=!0;return}u()});const h=m(()=>s.value&&s.value.initialData?(Object.keys(s.value.initialData).forEach(i=>{var d;(d=s.value)!=null&&d.initialData&&(Y(s.value.initialData[i])||(s.value.initialData[i]=_e(s.value.initialData[i])))}),{...s.value.initialData,...o.reactiveVariableMap}):o.reactiveVariableMap),g=m(()=>o.eventMap(h.value));return n.value?v(n.value):u(),t({clearRoutingCache:()=>{Object.keys(c).forEach(i=>{delete c[i]}),sessionStorage.clear()}}),(i,d)=>s.value?(y(),S(St,{key:s.value.id,widgets:s.value.children,widgetMap:o.widgetMap,eventMap:g.value,reactiveVariableMap:h.value},null,8,["widgets","widgetMap","eventMap","reactiveVariableMap"])):X("",!0)}});export{ie as N,Vt as _,$ as a,St as b,mt as s};
