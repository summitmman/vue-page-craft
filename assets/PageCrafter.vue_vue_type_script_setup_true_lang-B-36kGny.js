function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/WidgetsRenderer-DlhaxVP1.js","assets/index-BciM9UMA.js","assets/index-Bi55jKNN.css","assets/DynamicString-BgjPz250.js","assets/VIf-Cv3g45z8.js","assets/VFor-B0_9s-Jf.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{d as R,i as m,L as q,c as S,_ as w,k as se,b as pe,o as d,a as y,aX as le,aY as z,w as k,F as ce,f as K,G as ue,aZ as fe,aj as de,aU as H,Z as J,a1 as he,a_ as L,a$ as ge,V as ve,B as G,r as ye}from"./index-BciM9UMA.js";var M=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var be="Expected a function",X="__lodash_hash_undefined__",Y=1/0,Me="[object Function]",me="[object GeneratorFunction]",we="[object Symbol]",Se=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Oe=/^\w*$/,Ve=/^\./,Ce=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,je=/[\\^$.*+?()[\]{}|]/g,Pe=/\\(\\)?/g,Re=/^\[object .+?Constructor\]$/,Ee=typeof M=="object"&&M&&M.Object===Object&&M,De=typeof self=="object"&&self&&self.Object===Object&&self,E=Ee||De||Function("return this")();function Ie(e,t){return e==null?void 0:e[t]}function $e(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch{}return t}var Fe=Array.prototype,Te=Function.prototype,Z=Object.prototype,j=E["__core-js_shared__"],B=function(){var e=/[^.]+$/.exec(j&&j.keys&&j.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Q=Te.toString,D=Z.hasOwnProperty,ee=Z.toString,Ae=RegExp("^"+Q.call(D).replace(je,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),N=E.Symbol,xe=Fe.splice,ke=te(E,"Map"),_=te(Object,"create"),W=N?N.prototype:void 0,U=W?W.toString:void 0;function h(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}function He(){this.__data__=_?_(null):{}}function Je(e){return this.has(e)&&delete this.__data__[e]}function Le(e){var t=this.__data__;if(_){var r=t[e];return r===X?void 0:r}return D.call(t,e)?t[e]:void 0}function Ge(e){var t=this.__data__;return _?t[e]!==void 0:D.call(t,e)}function Be(e,t){var r=this.__data__;return r[e]=_&&t===void 0?X:t,this}h.prototype.clear=He;h.prototype.delete=Je;h.prototype.get=Le;h.prototype.has=Ge;h.prototype.set=Be;function v(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}function Ne(){this.__data__=[]}function We(e){var t=this.__data__,r=O(t,e);if(r<0)return!1;var a=t.length-1;return r==a?t.pop():xe.call(t,r,1),!0}function Ue(e){var t=this.__data__,r=O(t,e);return r<0?void 0:t[r][1]}function qe(e){return O(this.__data__,e)>-1}function ze(e,t){var r=this.__data__,a=O(r,e);return a<0?r.push([e,t]):r[a][1]=t,this}v.prototype.clear=Ne;v.prototype.delete=We;v.prototype.get=Ue;v.prototype.has=qe;v.prototype.set=ze;function g(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}function Ke(){this.__data__={hash:new h,map:new(ke||v),string:new h}}function Xe(e){return V(this,e).delete(e)}function Ye(e){return V(this,e).get(e)}function Ze(e){return V(this,e).has(e)}function Qe(e,t){return V(this,e).set(e,t),this}g.prototype.clear=Ke;g.prototype.delete=Xe;g.prototype.get=Ye;g.prototype.has=Ze;g.prototype.set=Qe;function O(e,t){for(var r=e.length;r--;)if(ct(e[r][0],t))return r;return-1}function et(e,t){t=nt(t,e)?[t]:at(t);for(var r=0,a=t.length;e!=null&&r<a;)e=e[pt(t[r++])];return r&&r==a?e:void 0}function tt(e){if(!ae(e)||ot(e))return!1;var t=ut(e)||$e(e)?Ae:Re;return t.test(lt(e))}function rt(e){if(typeof e=="string")return e;if($(e))return U?U.call(e):"";var t=e+"";return t=="0"&&1/e==-Y?"-0":t}function at(e){return re(e)?e:st(e)}function V(e,t){var r=e.__data__;return it(t)?r[typeof t=="string"?"string":"hash"]:r.map}function te(e,t){var r=Ie(e,t);return tt(r)?r:void 0}function nt(e,t){if(re(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||$(e)?!0:Oe.test(e)||!Se.test(e)||t!=null&&e in Object(t)}function it(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function ot(e){return!!B&&B in e}var st=I(function(e){e=dt(e);var t=[];return Ve.test(e)&&t.push(""),e.replace(Ce,function(r,a,n,c){t.push(n?c.replace(Pe,"$1"):a||r)}),t});function pt(e){if(typeof e=="string"||$(e))return e;var t=e+"";return t=="0"&&1/e==-Y?"-0":t}function lt(e){if(e!=null){try{return Q.call(e)}catch{}try{return e+""}catch{}}return""}function I(e,t){if(typeof e!="function"||t&&typeof t!="function")throw new TypeError(be);var r=function(){var a=arguments,n=t?t.apply(this,a):a[0],c=r.cache;if(c.has(n))return c.get(n);var p=e.apply(this,a);return r.cache=c.set(n,p),p};return r.cache=new(I.Cache||g),r}I.Cache=g;function ct(e,t){return e===t||e!==e&&t!==t}var re=Array.isArray;function ut(e){var t=ae(e)?ee.call(e):"";return t==Me||t==me}function ae(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function ft(e){return!!e&&typeof e=="object"}function $(e){return typeof e=="symbol"||ft(e)&&ee.call(e)==we}function dt(e){return e==null?"":rt(e)}function ht(e,t,r){var a=e==null?void 0:et(e,t);return a===void 0?r:a}var gt=ht;const P=_e(gt),ne=new RegExp(/(\{\{)[^{}]+(\}\})/),vt=e=>{var p;const t=e.replace("{{","").replace("}}","").trim(),a=((p=new RegExp(/[\.\[\?]/).exec(t))==null?void 0:p.index)??-1;let n=t,c="";return a>-1&&(n=t.substring(0,a),c=t.substring(a+1)),{variablePart:n,theRest:c}},yt=(e,t,r={})=>{let a=e;const n=[];for(;a;){const c=ne.exec(a);if(c==null){n.push(a),a="";continue}const p=c[0],l=c.index,o=l+p.length;l>0&&n.push(a.substring(0,l));const{variablePart:i,theRest:u}=vt(p);t[i]!=null?n.push({rVar:t[i],theRest:u}):r[i]!=null?n.push(r[i]):n.push(p),o>=a.length?a="":a=a.substring(o)}return n},_t=R({props:{widget:{type:Object,default:()=>{}},widgetMap:{type:Object,default:()=>{}},eventMap:{type:Object,default:()=>{}},reactiveVariableMap:{type:Object,default:()=>{}}},components:{WidgetsRenderer:m(()=>w(()=>import("./WidgetsRenderer-DlhaxVP1.js"),__vite__mapDeps([0,1,2])))},setup(e){return(()=>{const{widget:r}=e;r.events&&Object.keys(r.events).forEach(a=>{if(!r.events)return;const n=r.events&&r.events[a];typeof n!="function"&&(n&&e.eventMap[n]?r.events[a]=e.eventMap[n]:r.events[a]=()=>{console.error(`Event ${n} not found`)})}),r.props&&Object.keys(r.props).forEach(a=>{if(r.props){if(r.props[a]){const n=r.props[a];if(typeof n=="string"&&ne.exec(n)){const p=yt(n,e.reactiveVariableMap);if(p.length===1){const l=p[0];if(typeof l!="string"&&typeof l!="function"){const{rVar:o,theRest:i}=l;i?q(o)?r.props[a]=P(o.value,i):r.props[a]=P(o,i):r.props[a]=o}else r.props[a]=l}else r.props[a]=S(()=>p.reduce((l,o)=>{if(typeof o=="function")return l;if(typeof o=="string")return l+o;const{rVar:i,theRest:u}=o;return u?l+=P(i.value,u):l+=i.value,l},""))}}if(a.includes("v-model")){const c=a.split(":")[1]??"modelValue";r.props[c]=r.props[a],r.events||(r.events={}),r.events[`update:${c}`]=p=>{r.props&&(r.props[a].value=p)}}}}),r.type==="v-if"&&(r.props||(r.props={}),r.props.widgetMap=e.widgetMap,r.props.eventMap=e.eventMap,r.props.reactiveVariableMap=e.reactiveVariableMap),r.type==="v-for"&&(r.props||(r.props={}),r.props.loopChildren=r.children,r.props.widgetMap=e.widgetMap,r.props.eventMap=e.eventMap,r.props.reactiveVariableMap=e.reactiveVariableMap)})(),{props:e,...e.widget.props,get propsBindings(){const r={};return Object.keys(this).forEach(a=>{a!=="propsBindings"&&a!=="props"&&(r[a]=this[a])}),r}}}});function bt(e,t,r,a,n,c){const p=pe("WidgetsRenderer");return d(),y(de(e.props.widgetMap[e.props.widget.type??""]??e.props.widget.type),ue(e.propsBindings,fe(e.props.widget.events??{})),le({default:k(()=>[e.props.widget.children?(d(),y(p,{key:0,widgets:e.props.widget.children,widgetMap:e.props.widgetMap,eventMap:e.props.eventMap,reactiveVariableMap:e.props.reactiveVariableMap},null,8,["widgets","widgetMap","eventMap","reactiveVariableMap"])):K("",!0)]),_:2},[z(Object.keys(e.props.widget.slots??{}),(l,o)=>({name:l,fn:k(i=>{var u;return[ce(p,{widgets:JSON.parse(JSON.stringify((e.props.widget.slots??{})[l])),widgetMap:e.props.widgetMap,eventMap:e.props.eventMap,reactiveVariableMap:{...e.props.reactiveVariableMap,[((u=e.props.widget.props)==null?void 0:u.id)??""+l+"SlotProps"]:i}},null,8,["widgets","widgetMap","eventMap","reactiveVariableMap"])]})}))]),1040)}const Mt=se(_t,[["render",bt]]),mt=R({__name:"WidgetsRenderer",props:{widgets:{type:Array,default:()=>[]},widgetMap:{type:Object,default:()=>{}},eventMap:{type:Object,default:()=>{}},reactiveVariableMap:{type:Object,default:()=>{}}},setup(e){const t=m(()=>w(()=>import("./DynamicString-BgjPz250.js"),__vite__mapDeps([3,1,2]))),r=m(()=>w(()=>import("./VIf-Cv3g45z8.js"),__vite__mapDeps([4,1,2]))),a=m(()=>w(()=>import("./VFor-B0_9s-Jf.js"),__vite__mapDeps([5,1,2]))),n=e,c=S(()=>({...n.widgetMap,"v-if":r,"v-for":a}));return(p,l)=>(d(!0),H(J,null,z(n.widgets,(o,i)=>(d(),H(J,{key:(typeof o=="string"?o:o.id+o.type)+i},[typeof o=="string"?(d(),y(he(t),{key:0,str:o,reactiveVariableMap:n.reactiveVariableMap},null,8,["str","reactiveVariableMap"])):(d(),y(Mt,{key:1,widget:o,widgetMap:c.value,eventMap:n.eventMap,reactiveVariableMap:n.reactiveVariableMap},null,8,["widget","widgetMap","eventMap","reactiveVariableMap"]))],64))),128))}});var ie=(e=>(e.Push="push",e.Replace="replace",e.ReplaceIfFirst="replaceIfFirst",e))(ie||{});const Ot=R({__name:"PageCrafter",props:L({widgetMap:{type:Object,default:()=>{}},eventMap:{type:Function,default:()=>{}},reactiveVariableMap:{type:Object,default:()=>{}},router:{type:Object,required:!1},route:{type:Object,required:!1}},{page:{type:Object,required:!1},pageModifiers:{}}),emits:L(["no-schema"],["update:page"]),setup(e,{expose:t,emit:r}){const a=ge(e,"page"),n=e,c=r,p={};let l=!1,o=!1;const i=ve(JSON.parse(JSON.stringify(null))),u=s=>{var f;if(o){o=!1;return}if(!(!((f=s.route)!=null&&f.path)||!n.route||!n.router)){try{sessionStorage.setItem(s.route.path,JSON.stringify(s))}catch(b){console.error("Some error in setting item in sessionStorage (probably data is too large or sessionStorage is full)",b),console.log("Using fallback cache"),p[s.route.path]=s}n.route.fullPath!==s.route.path&&(l=!0,s.route.navigationType===ie.Replace?n.router.replace(s.route.path):n.router.push(s.route.path))}},F=s=>{i.value=JSON.parse(JSON.stringify(s)),u(s)},T=()=>{c("no-schema"),l=!1,o=!1};G(a,()=>{a.value&&F(a.value)}),G(()=>{var s;return(s=n.route)==null?void 0:s.fullPath},()=>{var x;if(l){l=!1;return}if(!n.route||!n.router)return;const s=((x=n.route)==null?void 0:x.fullPath)??"";if(!s)return;const f=sessionStorage.getItem(s);if(f){try{const C=JSON.parse(f);a.value=C,o=!0}catch(C){console.error("Unable to parse cached schema",C),sessionStorage.removeItem(s)}return}const b=p[s];if(b){a.value=b,o=!0;return}T()});const A=S(()=>i.value&&i.value.initialData?(Object.keys(i.value.initialData).forEach(s=>{var f;(f=i.value)!=null&&f.initialData&&(q(i.value.initialData[s])||(i.value.initialData[s]=ye(i.value.initialData[s])))}),{...i.value.initialData,...n.reactiveVariableMap}):n.reactiveVariableMap),oe=S(()=>n.eventMap(A.value));return a.value?F(a.value):T(),t({clearRoutingCache:()=>{Object.keys(p).forEach(s=>{delete p[s]}),sessionStorage.clear()}}),(s,f)=>i.value?(d(),y(mt,{key:i.value.id,widgets:i.value.children,widgetMap:n.widgetMap,eventMap:oe.value,reactiveVariableMap:A.value},null,8,["widgets","widgetMap","eventMap","reactiveVariableMap"])):K("",!0)}});export{ie as N,Ot as _,P as a,mt as b,yt as s};
