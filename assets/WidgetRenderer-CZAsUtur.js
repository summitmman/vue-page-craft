import{r as h,s as g,_ as f}from"./utils-ClaU98Pv.js";import{a as m}from"./PageCrafter.vue_vue_type_script_setup_true_lang-DfELXjmy.js";import{d as y,L as w,c as b,l as O,b as j,o as l,a as d,a$ as C,aY as $,w as u,f as E,i as R,G as V,b0 as S,aj as B}from"./index-Be-jZZGx.js";const k=y({props:{schema:{type:Object,default:()=>{}},widgets:{type:Object,default:()=>{}},events:{type:Object,default:()=>{}},state:{type:Object,default:()=>{}},store:{type:Object,default:()=>{}}},components:{WidgetsRenderer:m},setup(s){return(()=>{const{schema:e}=s;e.events&&Object.keys(e.events).forEach(t=>{if(!e.events)return;const p=e.events&&e.events[t];if(typeof p=="function")return;let n=p.replace("{{","").replace("}}","").trim();n&&s.events[n]?e.events[t]=s.events[n]:e.events[t]=()=>{console.error(`Event ${n} not found`)}}),e.props&&Object.keys(e.props).forEach(t=>{if(e.props){if(e.props[t]!=null){const p=e.props[t];if(typeof p=="string"&&h.exec(p)){const i=g(p,s.state,s.store);if(i.length===1){const o=i[0];if(typeof o!="string"&&typeof o!="function"){const{rVar:r,theRest:a}=o;a?w(r)?e.props[t]=f(r.value,a):e.props[t]=f(r,a):e.props[t]=r}else e.props[t]=o}else e.props[t]=b(()=>i.reduce((o,r)=>{if(typeof r=="function")return o;if(typeof r=="string")return o+r;const{rVar:a,theRest:c}=r;return c?o+=f(a.value,c):o+=a.value,o},""))}}if(t.includes("v-model")){const n=t.split(":")[1]??"modelValue";e.props[n]=e.props[t],e.events||(e.events={}),e.events[`update:${n}`]=i=>{e.props&&(e.props[t].value=i)}}}}),e.type==="v-if"&&(e.props||(e.props={}),e.props.widgets=s.widgets,e.props.events=s.events,e.props.state=s.state,e.props.store=s.store),e.type==="v-for"&&(e.props||(e.props={}),e.props.loopChildren=e.children,e.props.widgets=s.widgets,e.props.events=s.events,e.props.state=s.state,e.props.store=s.store)})(),{props:s,...s.schema.props,get propsBindings(){const e={};return Object.keys(this).forEach(t=>{t!=="propsBindings"&&t!=="props"&&(e[t]=this[t])}),e}}}});function P(s,v,e,t,p,n){const i=j("WidgetsRenderer");return l(),d(B(s.props.widgets[s.props.schema.type??""]??s.props.schema.type),V(s.propsBindings,S(s.props.schema.events??{})),C({default:u(()=>[s.props.schema.children?(l(),d(i,{key:0,schema:s.props.schema.children,widgets:s.props.widgets,events:s.props.events,state:s.props.state,store:s.props.store},null,8,["schema","widgets","events","state","store"])):R("",!0)]),_:2},[$(Object.keys(s.props.schema.slots??{}),(o,r)=>({name:o,fn:u(a=>{var c;return[E(i,{schema:JSON.parse(JSON.stringify((s.props.schema.slots??{})[o])),widgets:s.props.widgets,events:s.props.events,state:{...s.props.state,[((c=s.props.schema.props)==null?void 0:c.id)??""+o+"SlotProps"]:a},store:s.props.store},null,8,["schema","widgets","events","state","store"])]})}))]),1040)}const D=O(k,[["render",P]]);export{D as default};
