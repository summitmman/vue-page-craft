function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/WidgetsRenderer-CvcehOmN.js","assets/index-WB8KOmOZ.js","assets/index-CHJscWOQ.css","assets/DynamicString-BdJh8PnO.js","assets/VIf-dHkcRSsn.js","assets/VFor-DU9Nk4L6.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{d as D,i as S,L as q,c as R,_ as C,k as oe,b as se,o as y,a as m,aY as pe,aZ as W,w as x,F as ce,f as z,G as le,a_ as ue,aj as fe,aU as k,Z as H,a1 as de,a$ as he,b0 as ge,V as ve,B as J,r as ye}from"./index-WB8KOmOZ.js";var O=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var be="Expected a function",K="__lodash_hash_undefined__",Y=1/0,Me="[object Function]",me="[object GeneratorFunction]",we="[object Symbol]",Oe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Se=/^\w*$/,Ce=/^\./,Re=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ve=/[\\^$.*+?()[\]{}|]/g,je=/\\(\\)?/g,Pe=/^\[object .+?Constructor\]$/,Ee=typeof O=="object"&&O&&O.Object===Object&&O,De=typeof self=="object"&&self&&self.Object===Object&&self,I=Ee||De||Function("return this")();function Ie(e,r){return e==null?void 0:e[r]}function Fe(e){var r=!1;if(e!=null&&typeof e.toString!="function")try{r=!!(e+"")}catch{}return r}var Te=Array.prototype,$e=Function.prototype,Z=Object.prototype,P=I["__core-js_shared__"],L=function(){var e=/[^.]+$/.exec(P&&P.keys&&P.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),X=$e.toString,F=Z.hasOwnProperty,Q=Z.toString,Ne=RegExp("^"+X.call(F).replace(Ve,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),G=I.Symbol,Ae=Te.splice,xe=ee(I,"Map"),w=ee(Object,"create"),B=G?G.prototype:void 0,U=B?B.toString:void 0;function _(e){var r=-1,t=e?e.length:0;for(this.clear();++r<t;){var a=e[r];this.set(a[0],a[1])}}function ke(){this.__data__=w?w(null):{}}function He(e){return this.has(e)&&delete this.__data__[e]}function Je(e){var r=this.__data__;if(w){var t=r[e];return t===K?void 0:t}return F.call(r,e)?r[e]:void 0}function Le(e){var r=this.__data__;return w?r[e]!==void 0:F.call(r,e)}function Ge(e,r){var t=this.__data__;return t[e]=w&&r===void 0?K:r,this}_.prototype.clear=ke;_.prototype.delete=He;_.prototype.get=Je;_.prototype.has=Le;_.prototype.set=Ge;function M(e){var r=-1,t=e?e.length:0;for(this.clear();++r<t;){var a=e[r];this.set(a[0],a[1])}}function Be(){this.__data__=[]}function Ue(e){var r=this.__data__,t=V(r,e);if(t<0)return!1;var a=r.length-1;return t==a?r.pop():Ae.call(r,t,1),!0}function qe(e){var r=this.__data__,t=V(r,e);return t<0?void 0:r[t][1]}function We(e){return V(this.__data__,e)>-1}function ze(e,r){var t=this.__data__,a=V(t,e);return a<0?t.push([e,r]):t[a][1]=r,this}M.prototype.clear=Be;M.prototype.delete=Ue;M.prototype.get=qe;M.prototype.has=We;M.prototype.set=ze;function b(e){var r=-1,t=e?e.length:0;for(this.clear();++r<t;){var a=e[r];this.set(a[0],a[1])}}function Ke(){this.__data__={hash:new _,map:new(xe||M),string:new _}}function Ye(e){return j(this,e).delete(e)}function Ze(e){return j(this,e).get(e)}function Xe(e){return j(this,e).has(e)}function Qe(e,r){return j(this,e).set(e,r),this}b.prototype.clear=Ke;b.prototype.delete=Ye;b.prototype.get=Ze;b.prototype.has=Xe;b.prototype.set=Qe;function V(e,r){for(var t=e.length;t--;)if(lt(e[t][0],r))return t;return-1}function et(e,r){r=nt(r,e)?[r]:at(r);for(var t=0,a=r.length;e!=null&&t<a;)e=e[pt(r[t++])];return t&&t==a?e:void 0}function tt(e){if(!re(e)||ot(e))return!1;var r=ut(e)||Fe(e)?Ne:Pe;return r.test(ct(e))}function rt(e){if(typeof e=="string")return e;if($(e))return U?U.call(e):"";var r=e+"";return r=="0"&&1/e==-Y?"-0":r}function at(e){return te(e)?e:st(e)}function j(e,r){var t=e.__data__;return it(r)?t[typeof r=="string"?"string":"hash"]:t.map}function ee(e,r){var t=Ie(e,r);return tt(t)?t:void 0}function nt(e,r){if(te(e))return!1;var t=typeof e;return t=="number"||t=="symbol"||t=="boolean"||e==null||$(e)?!0:Se.test(e)||!Oe.test(e)||r!=null&&e in Object(r)}function it(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}function ot(e){return!!L&&L in e}var st=T(function(e){e=dt(e);var r=[];return Ce.test(e)&&r.push(""),e.replace(Re,function(t,a,n,p){r.push(n?p.replace(je,"$1"):a||t)}),r});function pt(e){if(typeof e=="string"||$(e))return e;var r=e+"";return r=="0"&&1/e==-Y?"-0":r}function ct(e){if(e!=null){try{return X.call(e)}catch{}try{return e+""}catch{}}return""}function T(e,r){if(typeof e!="function"||r&&typeof r!="function")throw new TypeError(be);var t=function(){var a=arguments,n=r?r.apply(this,a):a[0],p=t.cache;if(p.has(n))return p.get(n);var s=e.apply(this,a);return t.cache=p.set(n,s),s};return t.cache=new(T.Cache||b),t}T.Cache=b;function lt(e,r){return e===r||e!==e&&r!==r}var te=Array.isArray;function ut(e){var r=re(e)?Q.call(e):"";return r==Me||r==me}function re(e){var r=typeof e;return!!e&&(r=="object"||r=="function")}function ft(e){return!!e&&typeof e=="object"}function $(e){return typeof e=="symbol"||ft(e)&&Q.call(e)==we}function dt(e){return e==null?"":rt(e)}function ht(e,r,t){var a=e==null?void 0:et(e,r);return a===void 0?t:a}var gt=ht;const E=_e(gt),ae=new RegExp(/(\{\{)[^{}]+(\}\})/),vt=e=>{var s;const r=e.replace("{{","").replace("}}","").trim(),a=((s=new RegExp(/[\.\[\?]/).exec(r))==null?void 0:s.index)??-1;let n=r,p="";return a>-1&&(n=r.substring(0,a),p=r.substring(a+1)),{variablePart:n,theRest:p}},yt=(e,r,t={})=>{let a=e;const n=[];for(;a;){const p=ae.exec(a);if(p==null){n.push(a),a="";continue}const s=p[0],o=p.index,c=o+s.length;o>0&&n.push(a.substring(0,o));const{variablePart:l,theRest:g}=vt(s);r[l]!=null?n.push({rVar:r[l],theRest:g}):t[l]!=null?n.push(t[l]):n.push(s),c>=a.length?a="":a=a.substring(c)}return n},_t=D({props:{widget:{type:Object,default:()=>{}},widgetMap:{type:Object,default:()=>{}},eventMap:{type:Object,default:()=>{}},reactiveVariableMap:{type:Object,default:()=>{}}},components:{WidgetsRenderer:S(()=>C(()=>import("./WidgetsRenderer-CvcehOmN.js"),__vite__mapDeps([0,1,2])))},setup(e){return(()=>{const{widget:t}=e;t.events&&Object.keys(t.events).forEach(a=>{if(!t.events)return;const n=t.events&&t.events[a];typeof n!="function"&&(n&&e.eventMap[n]?t.events[a]=e.eventMap[n]:t.events[a]=()=>{console.error(`Event ${n} not found`)})}),t.props&&Object.keys(t.props).forEach(a=>{if(t.props){if(t.props[a]){const n=t.props[a];if(typeof n=="string"&&ae.exec(n)){const s=yt(n,e.reactiveVariableMap);if(s.length===1){const o=s[0];if(typeof o!="string"&&typeof o!="function"){const{rVar:c,theRest:l}=o;l?q(c)?t.props[a]=E(c.value,l):t.props[a]=E(c,l):t.props[a]=c}else t.props[a]=o}else t.props[a]=R(()=>s.reduce((o,c)=>{if(typeof c=="function")return o;if(typeof c=="string")return o+c;const{rVar:l,theRest:g}=c;return g?o+=E(l.value,g):o+=l.value,o},""))}}if(a.includes("v-model")){const p=a.split(":")[1]??"modelValue";t.props[p]=t.props[a],t.events||(t.events={}),t.events[`update:${p}`]=s=>{t.props&&(t.props[a].value=s)}}}}),t.type==="v-if"&&(t.props||(t.props={}),t.props.widgetMap=e.widgetMap,t.props.eventMap=e.eventMap,t.props.reactiveVariableMap=e.reactiveVariableMap),t.type==="v-for"&&(t.props||(t.props={}),t.props.loopChildren=t.children,t.props.widgetMap=e.widgetMap,t.props.eventMap=e.eventMap,t.props.reactiveVariableMap=e.reactiveVariableMap)})(),{props:e,...e.widget.props,get propsBindings(){const t={};return Object.keys(this).forEach(a=>{a!=="propsBindings"&&a!=="props"&&(t[a]=this[a])}),t}}}});function bt(e,r,t,a,n,p){const s=se("WidgetsRenderer");return y(),m(fe(e.props.widgetMap[e.props.widget.type??""]??e.props.widget.type),le(e.propsBindings,ue(e.props.widget.events??{})),pe({default:x(()=>[e.props.widget.children?(y(),m(s,{key:0,widgets:e.props.widget.children,widgetMap:e.props.widgetMap,eventMap:e.props.eventMap,reactiveVariableMap:e.props.reactiveVariableMap},null,8,["widgets","widgetMap","eventMap","reactiveVariableMap"])):z("",!0)]),_:2},[W(Object.keys(e.props.widget.slots??{}),(o,c)=>({name:o,fn:x(l=>{var g;return[ce(s,{widgets:JSON.parse(JSON.stringify((e.props.widget.slots??{})[o])),widgetMap:e.props.widgetMap,eventMap:e.props.eventMap,reactiveVariableMap:{...e.props.reactiveVariableMap,[((g=e.props.widget.props)==null?void 0:g.id)??""+o+"SlotProps"]:l}},null,8,["widgets","widgetMap","eventMap","reactiveVariableMap"])]})}))]),1040)}const Mt=oe(_t,[["render",bt]]),mt=D({__name:"WidgetsRenderer",props:{widgets:{type:Array,default:()=>[]},widgetMap:{type:Object,default:()=>{}},eventMap:{type:Object,default:()=>{}},reactiveVariableMap:{type:Object,default:()=>{}}},setup(e){const r=S(()=>C(()=>import("./DynamicString-BdJh8PnO.js"),__vite__mapDeps([3,1,2]))),t=S(()=>C(()=>import("./VIf-dHkcRSsn.js"),__vite__mapDeps([4,1,2]))),a=S(()=>C(()=>import("./VFor-DU9Nk4L6.js"),__vite__mapDeps([5,1,2]))),n=e,p=R(()=>({...n.widgetMap,"v-if":t,"v-for":a}));return(s,o)=>(y(!0),k(H,null,W(n.widgets,(c,l)=>(y(),k(H,{key:(typeof c=="string"?c:c.id+c.type)+l},[typeof c=="string"?(y(),m(de(r),{key:0,str:c,reactiveVariableMap:n.reactiveVariableMap},null,8,["str","reactiveVariableMap"])):(y(),m(Mt,{key:1,widget:c,widgetMap:p.value,eventMap:n.eventMap,reactiveVariableMap:n.reactiveVariableMap},null,8,["widget","widgetMap","eventMap","reactiveVariableMap"]))],64))),128))}});var ne=(e=>(e.Push="push",e.Replace="replace",e.ReplaceIfFirst="replaceIfFirst",e))(ne||{});const St=D({__name:"PageCrafter",props:he({widgetMap:{type:Object,default:()=>{}},eventMap:{type:Function,default:()=>{}},reactiveVariableMap:{type:Object,default:()=>{}},router:{type:Object,required:!1},route:{type:Object,required:!1},routes:{type:Array,required:!1}},{page:{type:Object,required:!1},pageModifiers:{}}),emits:["update:page"],setup(e,{expose:r}){const t=ge(e,"page"),a=e,n={};let p=!1,s=!1;const o=ve(JSON.parse(JSON.stringify(null))),c=i=>{var d;if(s){s=!1;return}if(!(!((d=i.route)!=null&&d.path)||!a.route||!a.router)){try{sessionStorage.setItem(i.route.path,JSON.stringify(i))}catch(h){console.error("Some error in setting item in sessionStorage (probably data is too large or sessionStorage is full)",h),console.log("Using fallback cache"),n[i.route.path]=i}a.route.fullPath!==i.route.path&&(p=!0,i.route.navigationType===ne.Replace?a.router.replace(i.route.path):a.router.push(i.route.path))}},l=i=>{o.value=JSON.parse(JSON.stringify(i)),c(i)},g=async()=>{var i,d;if((i=a.routes)!=null&&i.length&&((d=a.route)!=null&&d.fullPath)){const h=a.routes.find(u=>{var f,v,A;return typeof u.path=="string"?((f=a.route)==null?void 0:f.fullPath)===u.path:(A=(((v=a.route)==null?void 0:v.fullPath)??"").match(u.path))==null?void 0:A.length});if(h){h.beforeNavigate&&h.beforeNavigate();try{const u=await h.schemaFetch();u&&(t.value=u,h.afterNavigate&&h.afterNavigate(u))}catch(u){const f=a.routes.find(v=>v.path==="error");if(f){const v=await f.schemaFetch({code:"ERROR_IN_FETCH",message:"There was an issue fetching the required route",error:u});v&&(t.value=v,f.afterNavigate&&f.afterNavigate(v))}}}else{const u=a.routes.find(f=>f.path==="error");if(u){const f=await u.schemaFetch({code:"ROUTE_NOT_FOUND",message:"Route not found"});f&&(t.value=f,u.afterNavigate&&u.afterNavigate(f))}}}p=!1,s=!1};J(t,()=>{t.value&&l(t.value)}),J(()=>{var i;return(i=a.route)==null?void 0:i.fullPath},()=>{var u;if(p){p=!1;return}if(!a.route||!a.router)return;const i=((u=a.route)==null?void 0:u.fullPath)??"";if(!i)return;const d=sessionStorage.getItem(i);if(d){try{const f=JSON.parse(d);t.value=f,s=!0}catch(f){console.error("Unable to parse cached schema",f),sessionStorage.removeItem(i)}return}const h=n[i];if(h){t.value=h,s=!0;return}g()});const N=R(()=>o.value&&o.value.initialData?(Object.keys(o.value.initialData).forEach(i=>{var d;(d=o.value)!=null&&d.initialData&&(q(o.value.initialData[i])||(o.value.initialData[i]=ye(o.value.initialData[i])))}),{...o.value.initialData,...a.reactiveVariableMap}):a.reactiveVariableMap),ie=R(()=>{var i;return a.eventMap(N.value,(i=t.value)==null?void 0:i.data)});return t.value?l(t.value):g(),r({clearRoutingCache:()=>{Object.keys(n).forEach(i=>{delete n[i]}),sessionStorage.clear()}}),(i,d)=>o.value?(y(),m(mt,{key:o.value.id,widgets:o.value.children,widgetMap:a.widgetMap,eventMap:ie.value,reactiveVariableMap:N.value},null,8,["widgets","widgetMap","eventMap","reactiveVariableMap"])):z("",!0)}});export{ne as N,St as _,E as a,mt as b,yt as s};
